'use strict';

var formValues   = require('./form-values')
  , s2p          = require('deferred/lib/sync-to-promise').call
  , displayError = require('../../view').displayError

  , onsubmit;

onsubmit = function (e) {
	var form, action, values, files, loaders = [], toLoad = 0, self=this;
	e.stopPropagation();
	e.preventDefault();

	form = e.target;
	action = form.action;
	values = formValues(form);

	s2p(this, values, form).end(displayError);
};

module.exports = function (cb) {
	return onsubmit.bind(cb);
};
