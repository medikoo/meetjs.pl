'use strict';

var emap = require('../../view').ownerDocument.engine.map
  , db   = require('../../../db')

module.exports = function (value, schema) {
	if (schema.type === 'email') {
		return this.a({ 'class': 'a-link-d prop-' + schema.name,
			href: 'mailto:' + value }, schema.toString(value));
	} else if (schema.type === 'file') {
		var obj = value && db.unserialize(value);
		return this.a({ 'class': 'a-link-d prop-' + schema.name,
			href: obj ? ('/file/' + obj._id + '/' + obj.name) : null },
			obj ? obj.name : '')();
	} else {
		return (value == null) ? '' : schema.toString(value);
	}
}.bind(emap);
