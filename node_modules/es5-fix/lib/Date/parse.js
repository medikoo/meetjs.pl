'use strict';

var isString = require('es5-ext/lib/String/is-string');

var re, _native;

if (!Date.parse('2011-01-01T00:00:00.000Z') || !Date.parse('2011-01-01')) {
	console.log('FIX DATE PARSE');

	re = /^(\d{4})-(\d{2})-(\d{2})(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?Z)?$/;
	_native = Date.parse;

	Date.parse = function (str) {
		var match;
		if (!isString(str) || !(match = str.match(re))) {
			return _native(str);
		}
		if (match[4]) {
			return Date.UTC(match[1], match[2] - 1, match[3], match[4], match[5],
				match[6] || 0, match[7] || 0);
		}
		return Date.UTC(match[1], match[2] - 1, match[3]);
	};
}
